{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/editor.js","webpack:///./src/tokenizer.js","webpack:///./test/index.js"],"names":["Editor","element","config","init","body","_background","children","_editor","_initIframe","_backgroundStyle","_editorStyle","contentDocument","innerHTML","_caret","_showCaret","_initEvents","_config","_onTip","onTip","_functions","_fields","_tokenizer","Tokenizer","_activeCaretRange","frameElement","styles","doc","style","createElement","type","overflow","head","appendChild","show","display","onscroll","scrollTop","scrollLeft","_updateCaret","onblur","onfocus","onkeyup","t","i","o","n","s","b","tip","_getParamDefinition","startOffset","context","arguments","length","name","argumentIndex","onkeydown","event","keyCode","preventDefault","execCommand","onmousedown","setTimeout","onpaste","text","clipboardData","getData","oninput","_renderBackground","ownerDocument","document","win","defaultView","parentWindow","sel","range","rect","getSelection","rangeCount","getRangeAt","selection","createRange","getBoundingClientRect","innerText","x","y","startContainer","top","left","position","token","positions","getPositions","content","firstChild","tokens","execute","html","forEach","validate","value","_formatToken","r","cls","functions","fields","_text","_tokenIndex","_tokens","_tokensPos","ch","test","charCodeAt","isNaN","Number","context_vars","push","nextChar","isDigit","createToken","validateNumber","start","isLetter","charAnalize","isBlank","readNumber","isQuotes","readString","readFunction","readField","readContextVar","isOperator","readOperator","isArgumentSeparator","readArgumentSeparator","readArgumentStart","readArgumentEnd","readBlank","readOther","editor","getElementById","setFunctions","description","setFields","a","bb"],"mappings":"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","file":"test.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./test/index.js\");\n","// @ts-check\n\n\nimport Tokenizer from './tokenizer'\n\nexport default class Editor{\n    constructor(element, config = {}){\n        element.init = () => {\n            let body\n\n            delete(element.init)\n\n            this._background = element.children[0].children[0]\n            this._editor = element.children[0].children[1]\n\n            this._initIframe(this._background, this._backgroundStyle)\n            this._initIframe(this._editor, this._editorStyle)\n\n            body = this._editor.contentDocument.body\n            body.innerHTML = \n                `<pre style=\"position:absolute;top:0;left:0;right:0;bottom:0;z-index:1;margin:0;padding:6px;overflow:auto\" spellcheck=\"false\" contenteditable=\"true\"></pre>\n                 <div class=\"caret\" style=\"left:6px;top:4px\"></div>`\n\n            this._caret = body.children[1]\n            \n            this._showCaret(false)\n            this._initEvents()\n        }\n\n        this._config(config)\n\n        element.innerHTML = \n        `<div class=\"formula-editor\" style=\"position:relative;width:100%;height:100%\">\n            <iframe frameborder=\"0\" class=\"formula-1\"></iframe>\n            <iframe frameborder=\"0\" class=\"formula-2\" onload=\"this.parentNode.parentNode.init();\"></iframe>\n        </div>`\n\n        this._onTip = config.onTip\n        this._functions = {}\n        this._fields = {}\n        this._tokenizer = new Tokenizer()\n        this._activeCaretRange = null\n    }\n\n    _initIframe(frameElement, styles){\n        let doc = frameElement.contentDocument;\n        let style = doc.createElement('style')\n        \n        style.type = 'text/css';\n        style.innerHTML = `* {font-family: monospace; }\\n${styles ? styles : ''}`;\n        \n        frameElement.contentDocument.body.style.overflow = 'hidden'\n        frameElement.contentDocument.head.appendChild(style)\n    }\n\n    _config(config){\n        this._backgroundStyle = `\n            .string{\n                color: #FFC107\n            }\n            .function, .field, .context_var{\n                color: #c0c0c0\n            }\n            .function.validate{\n                color:blue\n            }\n            .field-start, .field-end, .field.validate{\n                color:#009688\n            }\n            .context_var.validate{\n                font-weight: bold;\n                color: #000;\n            }\n            .operator{\n                color: #9C27B0;\n            }\n            .number.unvalidate {\n                color: red;\n                /* background-image: url(wiggle.png);\n                background-repeat: repeat-x;\n                background-position: bottom; */\n            }\n            pre{\n                padding:0;margin:0\n            }\n            body{\n                padding:6px;margin:0\n            }\n            `\n        this._editorStyle = `\n            .caret {\n                position:absolute;\n                height:19px;\n                width:1px;\n                background: black;\n                /*animation: 1s blink step-end infinite;\n                -webkit-animation: 1s blink step-end infinite;*/\n            }\n            @keyframes \"blink\" {\n              from, to { background: transparent; }\n              50% {background: black; }\n            }\n            @-webkit-keyframes \"blink\" {\n              from, to { background: transparent; }\n              50% {background: black; }\n            }\n            * {\n                color:transparent\n            }\n            `\n    }\n\n    _showCaret(show){\n        this._caret.style.display = show ? 'block' : 'none'\n    }\n\n    _initEvents(){\n        let doc = this._editor.contentDocument\n        let body= doc.body\n\n        body.children[0].onscroll = () => {\n            this._background.contentDocument.body.scrollTop = body.children[0].scrollTop\n            this._background.contentDocument.body.scrollLeft = body.children[0].scrollLeft\n\n            this._updateCaret()\n        }\n        body.children[0].onblur = () => {\n            this._showCaret(false)\n        }\n        body.children[0].onfocus = () => {\n            this._showCaret(true)\n        }\n\n        doc.onkeyup = () => {\n            let t, i, o, n, s, b\n            let tip = ''\n    \n            this._updateCaret()\n    \n            t = this._getParamDefinition(this._activeCaretRange.startOffset-1)\n            \n            if (t){\n                if (t.type=='function'){\n                    for (i in this._functions){\n                        tip += `<p>${i}</p>`\n                    }\n                } else if (t.type=='field-start' || t.type=='field'){\n                    for (i in this._fields){\n                        tip += `<p>${i}</p>`\n                    }\n                } else if (t.context){\n                    o = this._functions[t.context]\n                    if (o){\n                        tip = t.context + '('\n                        s = ''\n                        \n                        if (o.arguments){\n                            for (i=0; i<o.arguments.length; i++){\n                                n = o.arguments[i].name\n                                b = (i == t.argumentIndex)\n                                if (!b && n == '...'){\n                                    b = true\n                                }\n                                tip += s + ( b ? `<b style=\"background:#f3dd9b\">${n}</b>` : n)\n                                s = '; '\n                            }\n                            tip += ')'\n                        }\n                    }\n                    \n                }\n            }\n    \n            if (this._onTip){\n                this._onTip(tip)\n            }\n        }\n        doc.onkeydown = (event) => {\n            if (event.keyCode == 9){\n                event.preventDefault()\n                return doc.execCommand('insertText', false, '    ')\n            }\n            \n            this._updateCaret()\n        }\n        doc.onmousedown = () => {\n            setTimeout(() => {\n                this._updateCaret()\n            }, 100)\n        }\n        doc.onpaste = (event) => {\n            let text = event.clipboardData.getData(\"text/plain\")\n    \n            event.preventDefault()\n            doc.execCommand('insertText', false, text)\n        }    \n        doc.oninput = () => {\n            this._updateCaret()\n            this._renderBackground()\n        }\n    }\n\n    _updateCaret() {\n        let doc = this._editor.contentDocument.body.ownerDocument || this._editor.contentDocument.body.document\n        let win = doc.defaultView || doc.parentWindow\n        let sel, range\n        let rect\n\n        if (typeof win.getSelection != \"undefined\") {\n            sel = win.getSelection();\n            if (sel.rangeCount) {\n                range = sel.getRangeAt(0);\n            }\n        } else if ( (sel = doc.selection) && sel.type != \"Control\") {\n            range = doc.selection.createRange();\n        }\n\n        this._activeCaretRange = range\n        rect = range.getBoundingClientRect()\n\n        if (doc.body.innerText==''){\n            rect = {x:6, y:6}\n        } else if (rect.x==0 && rect.y==0){\n            rect = range.startContainer.getBoundingClientRect()\n        }\n\n        if (rect.x==0 && rect.y==0){\n            rect = {x:6, y:6}\n        }\n\n        this._caret.style.top = (rect.y-2) + 'px'\n        this._caret.style.left = rect.x + 'px'\n    }\n\n    _getParamDefinition(position){\n        /** @type {*} */\n        let token\n        let positions = this._tokenizer.getPositions()\n    \n        while (position >= 0){\n            token = positions[position]\n            \n            if (token){\n                return token\n            }\n    \n            position--\n        }\n    }\n\n    _renderBackground(){\n        let content = this._editor.contentDocument.body.firstChild.innerText\n        let tokens = this._tokenizer.execute(content)\n        let html = ''\n    \n        tokens.forEach(token => {\n            if (token.type=='function'){\n                token.validate = this._functions[token.value]\n            } else if (token.type=='field'){\n                token.validate = this._fields[token.value]\n            }\n\n            html += this._formatToken(token)\n        })\n    \n        this._background.contentDocument.body.innerHTML = '<pre>' + html + '</pre>'\n    }\n\n    _formatToken(token){\n        let r = token.value\n        let cls = token.type + (token.validate ? ' validate' : ' unvalidate')\n    \n        r = `<span class=\"${cls}\">${r}</span>`\n    \n        return r\n    }\n\n    setFunctions(functions){\n        this._functions = functions\n    }\n\n    setFields(fields){\n        this._fields = fields\n    }\n}\n","// @ts-check\n\nexport default class Tokenizer{\n    constructor(){\n        this._text = ''\n        this._tokenIndex = 0\n        this._tokens = null\n        this._tokensPos = {}\n    }\n\n    isArgumentSeparator(ch) {\n        return /;/.test(ch);\n    }\n    \n    isDigit(ch) {\n        return /\\d/.test(ch);\n    }\n    \n    isLetter(ch) {\n        return /[a-z]/i.test(ch);\n    }\n    \n    isOperator(ch) {\n        return /\\=|\\+|-|\\*|\\/|\\^/.test(ch);\n    }\n    \n    isQuotes(ch){\n        return ch == '\"'\n    }\n\n    isBlank(ch){\n        return (ch==' ' || ch=='\\t' || ch=='\\n' || ch.charCodeAt(0)==160)\n    }\n\n    validateNumber(value){\n        return !isNaN(Number(value))\n    }\n\n    validateContextVar(name){\n        let context_vars = {\n            '$INDEX': true\n        }\n    \n        return context_vars[name]\n    }\n\n    nextChar(){\n        return this._text[this._tokenIndex++]\n    }\n\n    createToken(position,token){\n        this._tokens.push(token)\n        this._tokensPos[position] = token\n    }\n\n    readNumber(context, ch, argumentIndex){\n        let value = ch\n        let position = this._tokenIndex - 1\n    \n        while (ch = this.nextChar()){\n            if (this.isDigit(ch) || ch==\".\") {\n                value += ch\n            } else {\n                break\n            }\n        }\n    \n        this._tokenIndex--\n\n        this.createToken(position, {\n            value,\n            context,\n            argumentIndex,\n            type: 'number',\n            validate: this.validateNumber(value)\n        })\n    }\n\n    readString(context, ch, argumentIndex){\n        let value = ch\n        let start = ch\n        let position = this._tokenIndex - 1\n    \n        while (ch = this.nextChar()){\n            value += ch\n            \n            if (start==ch) {\n                break\n            }\n        }\n        \n        this.createToken(position, {\n            value,\n            context,\n            argumentIndex,\n            type: 'string'\n        })\n    }\n\n    readFunction(context, ch, argumentIndex){\n        let value = ch\n        let position = this._tokenIndex - 1\n        \n        // nome da função\n        while (ch = this.nextChar()){\n            if(this.isLetter(ch) || this.isDigit(ch)) {\n                value += ch\n            } else {\n                break\n            }\n        }\n    \n        this._tokenIndex--\n\n        this.createToken(position, {\n            value,\n            context,\n            argumentIndex,\n            type: 'function'\n        })\n\n        while (ch = this.nextChar()){\n            if (ch == '('){\n                this.charAnalize(value, ch, 0)\n            } else if (ch == ')'){\n                this.charAnalize(context, ch, argumentIndex)\n                break\n            } else {\n                this.charAnalize(value, ch, 0)\n            }\n\n        }\n    }\n\n    readField(context, ch, argumentIndex){\n        let value = ''\n        let position = this._tokenIndex - 1\n        \n        this.createToken(position, {\n            value: '{',\n            context,\n            argumentIndex,\n            type: 'field-start',\n        })\n\n        while (ch = this.nextChar()){\n            if(ch == '}') {\n                break\n            }\n    \n            value += ch\n        }\n\n        if (value){\n            this.createToken(position + 1, {\n                value,\n                context,\n                argumentIndex,\n                type: 'field'\n            })\n        }\n\n        if (ch == '}'){\n            position = this._tokenIndex - 1\n            this.createToken(position, {\n                value: '}',\n                context,\n                argumentIndex,\n                type: 'field-end',\n            })\n        }\n    }\n\n    readContextVar(context, ch, argumentIndex){\n        let value = ch\n        let position = this._tokenIndex - 1\n    \n        while (ch = this.nextChar()){\n            if(this.isLetter(ch) || this.isDigit(ch)) {\n                value += ch\n            } else {\n                break\n            }\n        }\n    \n        this._tokenIndex--\n        \n        this.createToken(position, {\n            value,\n            context,\n            argumentIndex,\n            type: 'context_var'\n        })\n    }\n\n    readOperator(context, ch, argumentIndex){\n        let value = ch\n        let position = this._tokenIndex - 1\n        let n = this._text[this._tokenIndex]\n\n        if ( n == '='){\n            ch += n \n        }\n\n        this.createToken(position, {\n            value,\n            context,\n            argumentIndex,\n            type: 'operator'\n        })\n    }\n\n    readArgumentSeparator(context, ch, argumentIndex){\n        let position = this._tokenIndex - 1\n\n        argumentIndex++\n\n        this.createToken(position, {\n            value: ch,\n            context,\n            argumentIndex,\n            type: 'argument-separator'\n        })\n\n        while (ch = this.nextChar()){\n            \n            if (ch == ')'){\n                this._tokenIndex--\n                return\n            }\n            \n            this.charAnalize(context, ch, argumentIndex)\n        }\n    }\n\n    readArgumentStart(context, ch, argumentIndex){\n        let position = this._tokenIndex - 1\n            \n        this.createToken(position, {\n            value: ch,\n            context,\n            argumentIndex,\n            type: 'argument-start'\n        })\n\n        return 'argument-start'\n    }\n\n    readArgumentEnd(context, ch, argumentIndex){\n        let position = this._tokenIndex - 1\n            \n        this.createToken(position, {\n            value: ch,\n            context,\n            argumentIndex,\n            type: 'argument-end'\n        })\n\n        return 'argument-end'\n    }\n\n    readBlank(context, ch, argumentIndex){\n        let value = ch\n        let position = this._tokenIndex - 1\n        \n        while (ch = this.nextChar()){\n            if(this.isBlank(ch)) {\n                value += ch\n            } else {\n                break\n            }\n        }\n        \n        this._tokenIndex--\n\n        this.createToken(position, {\n            value,\n            context,\n            argumentIndex,\n            type: 'blank'\n        })\n    }\n\n    readOther(context, ch, argumentIndex){\n        let value = ch\n        let position = this._tokenIndex - 1\n        \n        this.createToken(position, {\n            value,\n            context,\n            argumentIndex,\n            type: 'other'\n        })\n    }\n\n    charAnalize(context, ch, argumentIndex){\n        // number      \n        if(this.isDigit(ch)) {\n            this.readNumber(context, ch, argumentIndex)\n        }\n        \n        // string\n        else if (this.isQuotes(ch)){\n            this.readString(context, ch, argumentIndex)\n        }\n\n        // função\n        else if (this.isLetter(ch)) {\n            this.readFunction(context, ch, argumentIndex)\n        }\n\n        // campo\n        else if (ch=='{') {\n            this.readField(context, ch, argumentIndex)\n        }\n\n        // variável de contexto\n        else if (ch=='$') {\n            this.readContextVar(context, ch, argumentIndex)\n        }\n        \n        // operador\n        else if (this.isOperator(ch)){\n            this.readOperator(context, ch, argumentIndex)\n        }\n\n        // separado de argumentos de função\n        else if (this.isArgumentSeparator(ch)){\n            this.readArgumentSeparator(context, ch, argumentIndex)\n        }\n        \n        // início de argumentos de função\n        else if (ch == '('){\n            return this.readArgumentStart(context, ch, argumentIndex)\n        }\n\n        // fim de argumentos de função\n        else if (ch == ')'){\n            return this.readArgumentEnd(context, ch, argumentIndex)\n        }\n\n        else if (this.isBlank(ch)){\n            this.readBlank(context, ch, argumentIndex)\n        }\n\n        else {\n            this.readOther(context, ch, argumentIndex)\n        }\n    }\n\n    execute(text){\n        let ch\n\n        this._text = text\n        this._tokens = []\n        this._tokenIndex = 0\n        this._tokensPos = {}\n\n        while (ch = this.nextChar()){\n            this.charAnalize(null, ch, 0)\n        }\n\n        return this._tokens;\n\n    }\n\n    getPositions(){\n        return this._tokensPos\n    }\n}\n\n\n\n","// @ts-check\n\nimport Editor from '../src/editor'\n\nlet editor = new Editor(document.getElementById('editor'), {\n    onTip(tip){\n        document.getElementById('tip').innerHTML = tip\n    }\n})\n\neditor.setFunctions({\n    'sum': {\n        arguments: [\n            {\n                name: 'start', \n                type: 'text',\n                description: 'a primeira {context} do intervalo de soma'\n            },\n            {\n                name: 'end', \n                type: 'text',\n                description: 'a última {context} do intervalo de soma'\n            }\n        ]\n    },\n    'value': {\n        arguments: [\n            {\n                name: 'field', \n                type: 'field',\n                description: 'campo a definir o valor'\n            }\n        ]\n    },\n    'values': {\n        arguments: [\n            {\n                name: 'field1', \n                type: 'field',\n                description: 'campo a definir o valor'\n            },\n            {\n                name: 'field2', \n                type: 'field',\n                description: 'campo a definir o valor'\n            },\n            {\n                name: '...', \n                type: 'field',\n                description: 'campo a definir o valor'\n            }\n        ]\n    },\n    'if': {\n        arguments: [\n            {\n                name: 'condition', \n                type: 'boolean',\n                description: 'expressão a ser avaliada'\n            },\n            {\n                name: 'valueIfTrue', \n                type: 'field',\n                description: 'campo a definir o valor'\n            },\n            {\n                name: 'valueIfFalse', \n                type: 'field',\n                description: 'campo a definir o valor'\n            }\n        ]\n    },\n    'valuex': true\n})\n\neditor.setFields({\n    a:1,\n    bb:1\n})\n"],"sourceRoot":""}