{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/editor.js","webpack:///./src/tokenizer.js","webpack:///./test/index.js"],"names":["Editor","element","config","_config","innerHTML","_pre","querySelector","_textarea","_functions","_fields","_onTip","onTip","_onChange","onChange","onchange","onblur","_initEvents","textarea","pre","onscroll","style","top","scrollTop","left","scrollLeft","onkeydown","event","value1","value2","position","keyCode","preventDefault","selectionStart","value","substring","selectionEnd","length","focus","_render","onkeyup","_generateTip","onmouseup","oninput","i","o","n","s","b","e","tip","tokens","_tokens","p","index","findIndex","tk","cursor","token","document","getElementById","col","context","contextPos","type","validate","startsWith","arguments","name","several","html","forEach","_formatToken","height","offsetHeight","r","cls","functions","fields","disabled","setAttribute","removeAttribute","KEYWORDS","OPERATORS","opMatch","replace","opRegExp","RegExp","fpRegExp","reRegExp","intRegExp","multiCommentRegExp","commentRegExp","identRegExp","wsRegExp","strRegExp","Token","line","ws","indent","before","after","trailing","argumentCount","flags","operator","plain","prototype","toString","substr","tokenize","input","tabWidth","spaceBefore","indentation","lastToken","lastIdentifier","activeContext","list","contextPosition","sub","subline","indexOf","m","match","slice","lines","split","parseFloat","parseInt","eval","op","Error","push","pop","len","editor","setFunctions","description","setFields"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;;;;;;;qjBClFA;;AAEA;;;;;;;;IAEqBA,M;AACjB,oBAAYC,OAAZ,EAAiC;AAAA,YAAZC,MAAY,uEAAH,EAAG;;AAAA;;AAC7B,aAAKC,OAAL,CAAaD,MAAb;;AAEAD,gBAAQG,SAAR;;AAMA,aAAKC,IAAL,GAAYJ,QAAQK,aAAR,CAAsB,KAAtB,CAAZ;AACA,aAAKC,SAAL,GAAiBN,QAAQK,aAAR,CAAsB,UAAtB,CAAjB;;AAEA,aAAKE,UAAL,GAAkB,EAAlB;AACA,aAAKC,OAAL,GAAe,EAAf;;AAEA,aAAKC,MAAL,GAAcR,OAAOS,KAArB;AACA,aAAKC,SAAL,GAAiBV,OAAOW,QAAxB;;AAEA,aAAKC,QAAL,GAAgB,IAAhB;AACA,aAAKC,MAAL,GAAc,IAAd;;AAEA,aAAKC,WAAL;AACH;;;;gCAEOd,M,EAAO,CAEd;;;sCAEY;AAAA;;AACT,gBAAIe,WAAW,KAAKV,SAApB;AACA,gBAAIW,MAAM,KAAKb,IAAf;;AAEAY,qBAASE,QAAT,GAAoB,YAAM;AACtBD,oBAAIE,KAAJ,CAAUC,GAAV,GAAgB,CAACJ,SAASK,SAAV,GAAsB,IAAtC;AACAJ,oBAAIE,KAAJ,CAAUG,IAAV,GAAiBN,SAASO,UAAT,GAAsB,IAAvC;AACH,aAHD;AAIAP,qBAASQ,SAAT,GAAqB,UAACC,KAAD,EAAW;AAC5B,oBAAIC,eAAJ;AAAA,oBAAYC,eAAZ;AAAA,oBAAoBC,iBAApB;;AAEA,oBAAIH,MAAMI,OAAN,IAAiB,CAArB,EAAuB;AACnBJ,0BAAMK,cAAN;;AAEAF,+BAAWZ,SAASe,cAAT,GAA0B,CAArC;AACAL,6BAASV,SAASgB,KAAT,CAAeC,SAAf,CAAyB,CAAzB,EAA4BjB,SAASe,cAArC,CAAT;AACAJ,6BAASX,SAASgB,KAAT,CAAeC,SAAf,CAAyBjB,SAASkB,YAAlC,EAAgDlB,SAASgB,KAAT,CAAeG,MAA/D,CAAT;;AAEAnB,6BAASgB,KAAT,GAAoBN,MAApB,YAAiCC,MAAjC;AACAX,6BAASe,cAAT,GAA0BH,QAA1B;AACAZ,6BAASkB,YAAT,GAAwBN,QAAxB;AACAZ,6BAASoB,KAAT;;AAEA,0BAAKC,OAAL;;AAEA,2BAAO,KAAP;AACH;AACJ,aAnBD;AAoBArB,qBAASsB,OAAT,GAAmB,YAAM;AACrB,sBAAKC,YAAL;AACH,aAFD;AAGAvB,qBAASwB,SAAT,GAAqB,YAAM;AACvB;AACH,aAFD;AAGAxB,qBAASyB,OAAT,GAAmB,YAAM;AACrB,sBAAKJ,OAAL;;AAEA,oBAAI,MAAK1B,SAAT,EAAmB;AACf,0BAAKA,SAAL,CAAe,MAAKL,SAAL,CAAe0B,KAA9B;AACH;;AAED,oBAAI,MAAKnB,QAAT,EAAmB,MAAKA,QAAL,CAAc,MAAKP,SAAL,CAAe0B,KAA7B;AACtB,aARD;AASAhB,qBAASF,MAAT,GAAkB,YAAM;AACpB,oBAAI,MAAKA,MAAT,EAAiB,MAAKA,MAAL;AACpB,aAFD;AAGH;;;uCAEa;AACV,gBAAI4B,UAAJ;AAAA,gBAAOC,UAAP;AAAA,gBAAUC,UAAV;AAAA,gBAAaC,UAAb;AAAA,gBAAgBC,UAAhB;AAAA,gBAAmBC,UAAnB;AACA,gBAAIC,MAAM,EAAV;;AAEA,gBAAIC,SAAS,KAAKC,OAAL,IAAgB,EAA7B;AACA,gBAAIC,IAAI,KAAK7C,SAAL,CAAeyB,cAAf,GAA+B,CAAvC;AACA,gBAAIqB,QAAQH,OAAOI,SAAP,CAAiB,UAACC,EAAD,EAAQ;AAAC,uBAAOA,GAAGC,MAAH,IAAaJ,CAApB;AAAsB,aAAhD,CAAZ;AACA,gBAAIK,QAAQP,OAAOG,KAAP,CAAZ;;AAEA,gBAAI,CAACI,KAAL,EAAW;AACPA,wBAAQP,OAAO,CAAP,CAAR;AACH,aAFD,MAEM,IAAIO,MAAMD,MAAN,GAAeJ,CAAf,IAAoBA,KAAK,CAA7B,EAA+B;AACjCK,wBAAQP,OAAOG,QAAQ,CAAf,CAAR;AACH;;AAED,gBAAII,KAAJ,EAAU;AACNC,yBAASC,cAAT,CAAwB,SAAxB,EAAmCvD,SAAnC,GAA+CgD,IAAI,GAAJ,GAC/C,iBAD+C,GAC3BK,MAAMD,MADqB,GAE/C,iBAF+C,GAE3BC,MAAMG,GAFqB,GAG/C,iBAH+C,GAG3BH,MAAMI,OAHqB,GAI/C,iBAJ+C,GAI3BJ,MAAMK,UAJqB,GAK/C,iBAL+C,GAK3BL,MAAMxB,KAL1B;AAMH,aAPD,MAOO;AACHyB,yBAASC,cAAT,CAAwB,SAAxB,EAAmCvD,SAAnC,GAA+C,EAA/C;AACH;;AAED,gBAAIqD,KAAJ,EAAU;AACN,oBAAIA,MAAMM,IAAN,IAAY,UAAZ,IAA0B,CAACN,MAAMO,QAArC,EAA8C;AAC1C,yBAAKrB,CAAL,IAAU,KAAKnC,UAAf,EAA0B;AACtB,4BAAImC,EAAEsB,UAAF,CAAaR,MAAMxB,KAAnB,CAAJ,EAA8B;AAC1BgB,mDAAoBN,KAAGc,MAAMxB,KAAT,GAAiB,oBAAjB,GAAwC,EAA5D,WAAmEU,CAAnE;AACH;AACJ;AACJ,iBAND,MAMO,IAAIc,MAAMM,IAAN,IAAY,YAAZ,IAA4B,CAACN,MAAMO,QAAvC,EAAgD;AACnD,yBAAKrB,CAAL,IAAU,KAAKlC,OAAf,EAAuB;AACnBoC,4BAAIF,EAAET,SAAF,CAAY,CAAZ,EAAeS,EAAEP,MAAF,GAAW,CAA1B,CAAJ;AACA,4BAAIO,EAAEsB,UAAF,CAAaR,MAAMxB,KAAnB,CAAJ,EAA8B;AAC1BgB,mDAAoBJ,KAAGY,MAAMxB,KAAT,GAAiB,oBAAjB,GAAwC,EAA5D,WAAmEU,CAAnE;AACH;AACJ;AACJ,iBAPM,MAOA,IAAIc,MAAMI,OAAV,EAAkB;AACrBjB,wBAAI,KAAKpC,UAAL,CAAgBiD,MAAMI,OAAtB,CAAJ;AACA,wBAAIjB,CAAJ,EAAM;AACFK,8BAAMQ,MAAMI,OAAN,GAAgB,GAAtB;AACAf,4BAAI,EAAJ;;AAEA,4BAAIF,EAAEsB,SAAN,EAAgB;AACZlB,gCAAI,KAAJ;AACA,iCAAKL,IAAE,CAAP,EAAUA,IAAEC,EAAEsB,SAAF,CAAY9B,MAAxB,EAAgCO,GAAhC,EAAoC;AAChCE,oCAAID,EAAEsB,SAAF,CAAYvB,CAAZ,EAAewB,IAAnB;AACApB,oCAAKJ,KAAKc,MAAMK,UAAhB;;AAEA,oCAAIf,CAAJ,EAAM;AACFC,wCAAI,IAAJ;AACH;;AAEDC,uCAAOH,KAAMC,KAAMJ,KAAGC,EAAEsB,SAAF,CAAY9B,MAAZ,GAAmB,CAAtB,IAA2B,CAACY,CAA5B,IAAiCJ,EAAEsB,SAAF,CAAYvB,CAAZ,EAAeyB,OAAtD,sCAAkGvB,CAAlG,YAA4GA,CAAlH,CAAP;AACAC,oCAAI,IAAJ;AACH;;AAEDG,mCAAO,GAAP;AACH;AACJ;AACJ;AACJ;;AAEDS,qBAASC,cAAT,CAAwB,KAAxB,EAA+BvD,SAA/B,GAA2C6C,GAA3C;;AAEA;AACA;AACA;AACH;;AAED;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;kCAES;AAAA;;AACL,gBAAIC,SAAS,KAAKC,OAAL,GAAe,yBAAU,KAAK5C,SAAL,CAAe0B,KAAzB,CAA5B;AACA,gBAAIoC,OAAO,EAAX;;AAEAnB,mBAAOoB,OAAP,CAAe,iBAAS;AACpB,oBAAIb,MAAMM,IAAN,IAAc,UAAlB,EAA6B;AACzBN,0BAAMO,QAAN,GAAiB,OAAKxD,UAAL,CAAgBiD,MAAMxB,KAAtB,IAA+B,IAA/B,GAAsC,KAAvD;AACH,iBAFD,MAEO,IAAIwB,MAAMM,IAAN,IAAc,YAAlB,EAA+B;AAClCN,0BAAMO,QAAN,GAAiB,OAAKvD,OAAL,CAAagD,MAAMxB,KAAnB,IAA4B,IAA5B,GAAmC,KAApD;AACH,iBAFM,MAEA,IAAIwB,MAAMM,IAAN,IAAc,QAAlB,EAA2B;AAC9BN,0BAAMxB,KAAN,SAAkBwB,MAAMxB,KAAxB;AACH,iBAFM,MAEA,IAAIwB,MAAMM,IAAN,IAAc,mBAAlB,EAAsC;AACzCN,0BAAMxB,KAAN,SAAkBwB,MAAMxB,KAAxB;AACH,iBAFM,MAEA,IAAIwB,MAAMM,IAAN,IAAc,SAAlB,EAA4B;AAC/BN,0BAAMxB,KAAN,GAAc,IAAd;AACH;;AAEDoC,wBAAQ,OAAKE,YAAL,CAAkBd,KAAlB,CAAR;AACH,aAdD;;AAgBA,iBAAKpD,IAAL,CAAUD,SAAV,GAAsBiE,OAAO,KAA7B;AACA,iBAAK9D,SAAL,CAAea,KAAf,CAAqBoD,MAArB,GAA8B,KAAKnE,IAAL,CAAUoE,YAAV,GAAyB,IAAvD;AACH;;;qCAEYhB,K,EAAM;AACf,gBAAIiB,IAAIjB,MAAMxB,KAAd;AACA,gBAAI0C,MAAMlB,MAAMM,IAAN,IAAcN,MAAMO,QAAN,KAAiB,KAAjB,GAAyB,aAAzB,GAAyC,EAAvD,CAAV;;AAEAU,kCAAoBC,GAApB,UAA4BD,CAA5B;;AAEA,mBAAOA,CAAP;AACH;;;qCAEYE,S,EAAU;AACnB,iBAAKpE,UAAL,GAAkBoE,SAAlB;AACH;;;kCAESC,M,EAAO;AACb,iBAAKpE,OAAL,GAAeoE,MAAf;AACH;;;mCAES;AACN,mBAAO,KAAKtE,SAAL,CAAe0B,KAAtB;AACH;;;iCAEQA,K,EAAM;AACX,iBAAK1B,SAAL,CAAe0B,KAAf,GAAuBA,KAAvB;AACA,iBAAKK,OAAL;AACH;;;oCAEWL,K,EAAM;AACd,iBAAK1B,SAAL,CAAeuE,QAAf,GAA0B7C,KAA1B;AACAA,oBAAQ,KAAK5B,IAAL,CAAU0E,YAAV,CAAuB,UAAvB,EAAmC,EAAnC,CAAR,GAAiD,KAAK1E,IAAL,CAAU2E,eAAV,CAA0B,UAA1B,CAAjD;AACH;;;;;;kBAjPgBhF,M;;;;;;;;;;;;;;;;;ACJrB;;AAEA;;AAEA;;;;;;AAMA;;AAEA,IAAIiF,WAAW,CACX,OADW,EAEX,MAFW,EAEH,OAFG,EAEM,OAFN,EAEe,UAFf,EAGX,UAHW,EAGC,SAHD,EAGY,QAHZ,EAGsB,IAHtB,EAIX,MAJW,EAIH,MAJG,EAKX,OALW,EAKF,SALE,EAKS,KALT,EAKgB,UALhB,EAMX,IANW,EAML,IANK,EAMC,YAND,EAOX,KAPW,EAOJ,MAPI,EAQX,QARW,EASX,QATW,EAUX,MAVW,EAUH,OAVG,EAUM,MAVN,EAUc,KAVd,EAUqB,QAVrB,EAWX,KAXW,EAWJ,MAXI,EAYX,OAZW,EAYF,MAZE,CAAf;;AAeA,IAAIC,YAAY;AACZ,YAAQ,aADI;AAEZ,WAAQ,YAFI;AAGZ,WAAQ,YAHI;AAIZ,UAAQ,mBAJI;AAKZ,UAAQ,oBALI;AAMZ,UAAQ,oBANI;AAOZ,UAAQ,aAPI;AAQZ,UAAQ,cARI;AASZ,UAAQ,YATI;AAUZ,UAAQ,YAVI;AAWZ,UAAQ,YAXI;AAYZ,SAAQ,WAZI;AAaZ,SAAQ,OAbI;AAcZ,SAAQ,MAdI;AAeZ,SAAQ,OAfI;AAgBZ,UAAQ,IAhBI;AAiBZ,UAAQ,KAjBI;AAkBZ,SAAQ,YAlBI;AAmBZ,SAAQ,aAnBI;AAoBZ,SAAQ,aApBI;AAqBZ,WAAQ,WArBI;AAsBZ,UAAQ,IAtBI;AAuBZ,SAAQ,QAvBI;AAwBZ,WAAQ,WAxBI;AAyBZ,UAAQ,IAzBI;AA0BZ,UAAQ,KA1BI;AA2BZ,UAAQ,IA3BI;AA4BZ,SAAQ,IA5BI;AA6BZ,WAAQ,MA7BI;AA8BZ,UAAQ,KA9BI;AA+BZ,UAAQ,IA/BI;AAgCZ,SAAQ,IAhCI;AAiCZ,UAAQ,WAjCI;AAkCZ,UAAQ,WAlCI;AAmCZ,SAAQ,MAnCI;AAoCZ,SAAQ,OApCI;AAqCZ,SAAQ,KArCI;AAsCZ,SAAQ,KAtCI;AAuCZ,SAAQ,KAvCI;AAwCZ,SAAQ,KAxCI;AAyCZ,SAAQ,aAzCI;AA0CZ,SAAQ,KA1CI;AA2CZ,SAAQ,cA3CI;AA4CZ,SAAQ,eA5CI;AA6CZ,SAAQ,YA7CI;AA8CZ,SAAQ,aA9CI;AA+CZ,SAAQ,YA/CI;AAgDZ,SAAQ;;AAGZ;AACA;AApDgB,CAAhB,CAqDA,IAAIC,UAAU,GAAd;AACA,KAAK,IAAIxC,CAAT,IAAcuC,SAAd,EAAyB;AACrB,QAAIC,YAAY,GAAhB,EAAqB;AACjBA,mBAAW,IAAX;AACH;;AAEDA,eAAWxC,EAAEyC,OAAF,CAAU,yBAAV,EAAqC,MAArC,CAAX;AACH;;AAED,IAAIC,WAAW,IAAIC,MAAJ,CAAWH,OAAX,CAAf;AAAA,IACII,WAAW,+EADf;AAAA,IAEIC,WAAW,mDAFf;AAAA,IAGIC,YAAY,iCAHhB;AAAA,IAIIC,qBAAqB,wBAJzB;AAAA,IAKIC,gBAAgB,SALpB;AAAA,IAMIC,cAAc,UANlB;AAAA,IAOIC,WAAW,UAPf;AAAA,IAQIC,YAAY,mCARhB;;AAUA;AACA;AACA,SAASC,KAAT,GAAiB;AACb,SAAKnC,GAAL,GAAW,CAAX;AACA,SAAKoC,IAAL,GAAY,CAAZ;AACA,SAAKC,EAAL,GAAU;AACNC,gBAAQ,CADF;AAENC,gBAAQ,CAFF;AAGNC,eAAO,CAHD;AAINC,kBAAU;AAJJ,KAAV;;AAOA,SAAKxC,OAAL,GAAe,IAAf;AACA,SAAKC,UAAL,GAAkB,IAAlB;AACA,SAAKwC,aAAL,GAAqB,IAArB;AACA,SAAK9C,MAAL,GAAc,IAAd;AACA,SAAK+C,KAAL,GAAa,IAAb;AACA,SAAKC,QAAL,GAAgB,IAAhB;AACA,SAAKzC,IAAL,GAAY,IAAZ;AACA,SAAK9B,KAAL,GAAa,IAAb;AACA,SAAKwE,KAAL,GAAa,IAAb;AACA,SAAKzC,QAAL,GAAgB,IAAhB;AACH;;AAED+B,MAAMW,SAAN,CAAgBC,QAAhB,GAA2B,YAAW;AAClC,WAAO,MAAM,CAAC,KAAK5C,IAAL,GAAY,UAAb,EAAyB6C,MAAzB,CAAgC,CAAhC,EAAmC,EAAnC,CAAN,GAA+C,GAA/C,GACC,GADD,GACO,KAAKX,EAAL,CAAQC,MADf,GACwB,GADxB,GAC8B,KAAKD,EAAL,CAAQE,MADtC,GAC+C,GAD/C,GACqD,KAAKH,IAD1D,GAEC,GAFD,GAEO,KAAKpC,GAFZ,GAEkB,GAFlB,GAEwB,KAAKqC,EAAL,CAAQG,KAFhC,GAEwC,GAFxC,GAE8C,KAAKH,EAAL,CAAQI,QAFtD,GAGC,GAHD,GAGO,IAHP,GAGc,KAAKpE,KAHnB,GAG2B,GAHlC;AAIH,CALD;;AAOA;AACA;AACA,SAAS4E,QAAT,CAAkBC,KAAlB,EAAyBC,QAAzB,EAAmC;AAC/B,QAAIvD,SAAS,CAAb;AAAA,QACIwC,OAAO,CADX;AAAA,QAEIpC,MAAM,CAFV;AAAA,QAGIoD,cAAc,CAHlB;AAAA,QAIIC,cAAc,CAJlB;;AAKI;AACAxD,YAAQ,IAAIsC,KAAJ,EANZ;AAAA,QAOImB,YAAY,IAPhB;AAAA,QAQIC,iBAAiB,IARrB;AAAA,QASIC,gBAAgB,IATpB;AAAA,QAUIC,OAAO,EAVX;AAAA,QAWIxD,UAAU,EAXd;AAAA,QAYIyD,kBAAkB,CAZtB;;AAcA;AACA,WAAO9D,SAASsD,MAAM1E,MAAtB,EAA8B;;AAE1B;AACA,YAAIqB,MAAMM,IAAN,KAAe,YAAnB,EAAiC;AAC7BmD,wBAAYzD,KAAZ;AACH;;AAED;AACA;AACA,YAAI8D,MAAMT,MAAM5E,SAAN,CAAgBsB,MAAhB,CAAV;AAAA,YACIgE,UAAUD,IAAIrF,SAAJ,CAAc,CAAd,EAAiBqF,IAAIE,OAAJ,CAAY,IAAZ,CAAjB,CADd;AAAA,YAEIC,IAAI,IAFR;;AAIA;AACAjE,gBAAQ,IAAIsC,KAAJ,EAAR;AACAtC,cAAMuC,IAAN,GAAaA,IAAb;AACAvC,cAAMG,GAAN,GAAYA,GAAZ;AACAH,cAAMD,MAAN,GAAeA,MAAf;AACAC,cAAMwC,EAAN,CAASC,MAAT,GAAkBe,WAAlB;AACAxD,cAAMwC,EAAN,CAASE,MAAT,GAAkBe,UAAUnD,IAAV,KAAmB,SAAnB,GAA+B,CAA/B,GAAmCiD,WAArD;;AAEA;AACAA,sBAAc,CAAd;;AAEA;AACA,YAAIO,IAAI,CAAJ,MAAW,IAAf,EAAqB;;AAEjBL,sBAAUjB,EAAV,CAAaI,QAAb,GAAwB5C,MAAMwC,EAAN,CAASE,MAAjC;AACA1C,kBAAMwC,EAAN,CAASE,MAAT,GAAkB,CAAlB;;AAEA1C,kBAAMM,IAAN,GAAa,SAAb;AACAN,kBAAMxB,KAAN,GAAc,KAAd;AACAwB,kBAAMgD,KAAN,GAAcc,IAAI,CAAJ,CAAd;AACA3D,kBAAM,CAAN;AACAoC;;AAEJ;AACA;AACC,SAbD,MAaO,IAAK0B,IAAIH,IAAII,KAAJ,CAAUjC,kBAAV,CAAT,EAAyC;AAC5CjC,kBAAMM,IAAN,GAAa,eAAb;AACAN,kBAAMgD,KAAN,GAAciB,EAAE,CAAF,CAAd;AACAjE,kBAAMxB,KAAN,GAAcyF,EAAE,CAAF,EAAKE,KAAL,CAAW,CAAX,EAAc,CAAC,CAAf,CAAd;;AAEA,gBAAIC,QAAQpE,MAAMgD,KAAN,CAAYqB,KAAZ,CAAkB,IAAlB,CAAZ;AACA9B,oBAAQ6B,MAAMzF,MAAN,GAAe,CAAvB;AACAwB,kBAAMiE,MAAMA,MAAMzF,MAAN,GAAe,CAArB,EAAwBA,MAAxB,GAAiCsF,EAAE,CAAF,EAAKtF,MAAtC,GAA+C,CAArD;;AAEJ;AACC,SAVM,MAUA,IAAKsF,IAAIF,QAAQG,KAAR,CAAchC,aAAd,CAAT,EAAwC;AAC3ClC,kBAAMM,IAAN,GAAa,SAAb;AACAN,kBAAMgD,KAAN,GAAciB,EAAE,CAAF,CAAd;AACAjE,kBAAMxB,KAAN,GAAcyF,EAAE,CAAF,EAAKd,MAAL,CAAY,CAAZ,CAAd;;AAEJ;AACC,SANM,MAMA,IAAKc,IAAIH,IAAII,KAAJ,CAAUpC,QAAV,CAAT,EAA+B;AAClC9B,kBAAMM,IAAN,GAAa,OAAb;AACAN,kBAAMgD,KAAN,GAAciB,EAAE,CAAF,CAAd;AACAjE,kBAAMxB,KAAN,GAAc8F,WAAWL,EAAE,CAAF,CAAX,CAAd;;AAEJ;AACC,SANM,MAMA,IAAKA,IAAIH,IAAII,KAAJ,CAAUlC,SAAV,CAAT,EAAgC;AACnChC,kBAAMM,IAAN,GAAa,SAAb;AACAN,kBAAMgD,KAAN,GAAciB,EAAE,CAAF,CAAd;AACAjE,kBAAMxB,KAAN,GAAc+F,SAASN,EAAE,CAAF,CAAT,CAAd;;AAEJ;AACC,SANM,MAMA,IAAKA,IAAIH,IAAII,KAAJ,CAAU7B,SAAV,CAAT,EAAgC;AACnCrC,kBAAMM,IAAN,GAAa,QAAb;AACAN,kBAAMgD,KAAN,GAAciB,EAAE,CAAF,CAAd;AACAjE,kBAAMxB,KAAN,GAAcgG,KAAKP,EAAE,CAAF,CAAL,CAAd,CAHmC,CAGV;;AAE7B;AACC,SANM,MAMA,IAAIH,IAAItD,UAAJ,CAAe,GAAf,CAAJ,EAAyB;AAC5BR,kBAAMM,IAAN,GAAa,mBAAb;AACAN,kBAAMgD,KAAN,GAAcc,GAAd;AACA9D,kBAAMxB,KAAN,GAAcsF,IAAIrF,SAAJ,CAAc,CAAd,CAAd;AACAsB,sBAAU+D,IAAInF,MAAd;;AAEJ;AACC,SAPM,MAOA,IAAKsF,IAAIH,IAAII,KAAJ,CAAU/B,WAAV,CAAT,EAAkC;AACrCnC,kBAAMxB,KAAN,GAAcyF,EAAE,CAAF,CAAd;AACAjE,kBAAMM,IAAN,GAAakB,SAASwC,OAAT,CAAiBhE,MAAMxB,KAAvB,MAAkC,CAAC,CAAnC,GAAuC,SAAvC,GAAmD,YAAhE;AACA,gBAAIwB,MAAMM,IAAN,IAAc,YAAlB,EAA+B;AAC3BoD,iCAAiB1D,KAAjB;AACH;;AAEL;AACC,SARM,MAQA,IAAIyD,UAAUnD,IAAV,KAAmB,YAAnB,KAAoC2D,IAAIF,QAAQG,KAAR,CAAcnC,QAAd,CAAxC,CAAJ,EAAsE;AACzE/B,kBAAMM,IAAN,GAAa,QAAb;AACAN,kBAAMgD,KAAN,GAAciB,EAAE,CAAF,CAAd;AACAjE,kBAAMxB,KAAN,GAAcyF,EAAE,CAAF,CAAd;AACAjE,kBAAM8C,KAAN,GAAcmB,EAAE,CAAF,CAAd;;AAEJ;AACC,SAPM,MAOA,IAAKA,IAAIH,IAAII,KAAJ,CAAUtC,QAAV,CAAT,EAA+B;;AAElC;AACA,gBAAI6C,KAAKhD,UAAUwC,EAAE,CAAF,CAAV,CAAT;AACA,gBAAIQ,GAAGhG,SAAH,CAAa,CAAb,EAAgB,CAAhB,MAAuB,QAA3B,EAAqC;;AAEjCuB,sBAAMM,IAAN,GAAa,QAAb;AACA,oBAAImE,OAAO,QAAX,EAAqB;AACjBzE,0BAAM+C,QAAN,GAAiB,IAAjB;AAEH,iBAHD,MAGO;AACH/C,0BAAM+C,QAAN,GAAiB0B,GAAGhG,SAAH,CAAa,CAAb,CAAjB;AACH;AAEJ,aAVD,MAUO;AACHuB,sBAAMM,IAAN,GAAamE,EAAb;AACH;;AAEDzE,kBAAMxB,KAAN,GAAcyF,EAAE,CAAF,CAAd;;AAEJ;AACC,SArBM,MAqBA,IAAKA,IAAIH,IAAII,KAAJ,CAAU9B,QAAV,CAAT,EAA+B;;AAElCpC,kBAAMM,IAAN,GAAa,YAAb;AACAN,kBAAMxB,KAAN,GAAcyF,EAAE,CAAF,CAAd;;AAEA;AACAV,0BAAcU,EAAE,CAAF,EAAKtC,OAAL,CAAa,KAAb,EAAoB,MAApB,EAA4BhD,MAA1C;AACA,gBAAIwB,QAAQ,CAAZ,EAAe;AACXqD,8BAAcD,WAAd;AAEH,aAHD,MAGO;AACHE,0BAAUjB,EAAV,CAAaG,KAAb,GAAqBY,WAArB;AACH;;AAEL;AACC,SAfM,MAeA;AACH,kBAAM,IAAImB,KAAJ,CAAU,iBAAiBZ,IAAI,CAAJ,CAAjB,GAA0B,OAApC,CAAN;AACH;;AAED;AACA,YAAI9D,MAAMM,IAAN,KAAe,eAAnB,EAAoC;AAChC,gBAAIoD,cAAJ,EAAmB;AACf,oBAAI1D,MAAMxB,KAAN,IAAe,GAAnB,EAAuB;AACnBmF,oCAAgBD,cAAhB;AACAA,mCAAepD,IAAf,GAAsB,UAAtB;AACAF,4BAAQuE,IAAR,CAAajB,cAAb;;AAEAG,sCAAkB,CAAlB;AACAF,kCAAcd,aAAd,GAA8B,CAA9B;AACH,iBAPD,MAOO,IAAI7C,MAAMxB,KAAN,IAAe,GAAnB,EAAuB;AAC1B4B,4BAAQwE,GAAR;AACAjB,oCAAgBvD,QAAQA,QAAQzB,MAAR,GAAiB,CAAzB,CAAhB;AACH,iBAHM,MAGA,IAAIqB,MAAMxB,KAAN,IAAe,GAAnB,EAAuB;AAC1B,wBAAImF,aAAJ,EAAkB;AACdE;AACAF,sCAAcd,aAAd,GAA8BgB,kBAAkB,CAAhD;AACH;AACJ;AACJ;;AAED7D,kBAAMI,OAAN,GAAgBuD,gBAAgBA,cAAcnF,KAA9B,GAAsC,IAAtD;AACAwB,kBAAMK,UAAN,GAAmBL,MAAMI,OAAN,GAAgByD,eAAhB,GAAkC,IAArD;;AAEAD,iBAAKe,IAAL,CAAU3E,KAAV;AACH;;AAED;AACA,YAAI6E,MAAM,CAAV;AACA,YAAIZ,CAAJ,EAAO;AACHY,kBAAMZ,EAAE,CAAF,EAAKtF,MAAL,GAAcsF,EAAErE,KAAtB;AACH;;AAEDG,kBAAU8E,GAAV;AACA1E,eAAO0E,GAAP;AAEH;;AAED,WAAOjB,IAAP;AAEH;;kBAEcR,Q;;;;;;;;;;;;;;AClUf;;;;;;AAEA,IAAI0B,SAAS,IAAIvI,gBAAJ,CAAW0D,SAASC,cAAT,CAAwB,QAAxB,CAAX,EAA8C;AACvDhD,SADuD,iBACjDsC,GADiD,EAC7C;AACNS,iBAASC,cAAT,CAAwB,KAAxB,EAA+BvD,SAA/B,GAA2C6C,GAA3C;AACH;AAHsD,CAA9C,CAAb,C,CAJA;;AAUAsF,OAAOC,YAAP,CAAoB;AAChB,WAAO;AACHtE,mBAAW,CACP;AACIC,kBAAM,OADV;AAEIJ,kBAAM,MAFV;AAGI0E,yBAAa;AAHjB,SADO,EAMP;AACItE,kBAAM,KADV;AAEIJ,kBAAM,MAFV;AAGI0E,yBAAa;AAHjB,SANO;AADR,KADS;AAehB,aAAS;AACLvE,mBAAW,CACP;AACIC,kBAAM,OADV;AAEIJ,kBAAM,OAFV;AAGI0E,yBAAa;AAHjB,SADO;AADN,KAfO;AAwBhB,cAAU;AACNvE,mBAAW,CACP;AACIC,kBAAM,QADV;AAEIJ,kBAAM,OAFV;AAGI0E,yBAAa;AAHjB,SADO,EAMP;AACItE,kBAAM,QADV;AAEIJ,kBAAM,OAFV;AAGI0E,yBAAa;AAHjB,SANO,EAWP;AACItE,kBAAM,gBADV;AAEIJ,kBAAM,OAFV;AAGIK,qBAAS,IAHb;AAIIqE,yBAAa;AAJjB,SAXO;AADL,KAxBM;AA4ChB,UAAM;AACFvE,mBAAW,CACP;AACIC,kBAAM,WADV;AAEIJ,kBAAM,SAFV;AAGI0E,yBAAa;AAHjB,SADO,EAMP;AACItE,kBAAM,aADV;AAEIJ,kBAAM,OAFV;AAGI0E,yBAAa;AAHjB,SANO,EAWP;AACItE,kBAAM,cADV;AAEIJ,kBAAM,OAFV;AAGI0E,yBAAa;AAHjB,SAXO;AADT,KA5CU;AA+DhB,cAAU;AA/DM,CAApB;;AAkEAF,OAAOG,SAAP,CAAiB;AACb,SAAI,CADS;AAEb,UAAK;AAFQ,CAAjB,E","file":"test.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./test/index.js\");\n","// @ts-check\n\nimport tokenizer from './tokenizer'\n\nexport default class Editor{\n    constructor(element, config = {}){\n        this._config(config)\n\n        element.innerHTML = \n            `<div class=\"formula-editor\">\n                <pre class=\"formula-editor-pre\"> </pre>\n                <textarea class=\"formula-editor-textarea\" spellcheck=\"false\"></textarea>\n            </div>`\n\n        this._pre = element.querySelector('pre')\n        this._textarea = element.querySelector('textarea')\n        \n        this._functions = {}\n        this._fields = {}\n        \n        this._onTip = config.onTip\n        this._onChange = config.onChange\n\n        this.onchange = null\n        this.onblur = null\n        \n        this._initEvents()\n    }\n\n    _config(config){\n        \n    }\n\n    _initEvents(){\n        let textarea = this._textarea\n        let pre = this._pre\n\n        textarea.onscroll = () => {\n            pre.style.top = -textarea.scrollTop + 'px'\n            pre.style.left = textarea.scrollLeft + 'px'\n        }\n        textarea.onkeydown = (event) => {\n            let value1, value2, position\n\n            if (event.keyCode == 9){\n                event.preventDefault()\n\n                position = textarea.selectionStart + 4\n                value1 = textarea.value.substring(0, textarea.selectionStart)\n                value2 = textarea.value.substring(textarea.selectionEnd, textarea.value.length)\n\n                textarea.value = `${value1}    ${value2}`\n                textarea.selectionStart = position\n                textarea.selectionEnd = position\n                textarea.focus()\n\n                this._render()\n\n                return false\n            }\n        }\n        textarea.onkeyup = () => {\n            this._generateTip()\n        }\n        textarea.onmouseup = () => {\n            // this._generateTip()\n        }   \n        textarea.oninput = () => {\n            this._render()\n            \n            if (this._onChange){\n                this._onChange(this._textarea.value)\n            }\n            \n            if (this.onchange) this.onchange(this._textarea.value)\n        }\n        textarea.onblur = () => {\n            if (this.onblur) this.onblur()\n        }\n    }\n\n    _generateTip(){\n        let i, o, n, s, b, e\n        let tip = ''\n\n        let tokens = this._tokens || []\n        let p = this._textarea.selectionStart -1\n        let index = tokens.findIndex((tk) => {return tk.cursor >= p})\n        let token = tokens[index]\n\n        if (!token){\n            token = tokens[0]\n        }else if (token.cursor > p && p >= 0){\n            token = tokens[index - 1]\n        }\n        \n        if (token){\n            document.getElementById('console').innerHTML = p + ',' + \n            '\\ncursor     = ' + token.cursor +\n            '\\ncol        = ' + token.col + \n            '\\ncontext    = ' + token.context + \n            '\\ncontextPos = ' + token.contextPos +\n            '\\nvalue      = ' + token.value\n        } else {\n            document.getElementById('console').innerHTML = ''\n        }\n\n        if (token){\n            if (token.type=='FUNCTION' && !token.validate){\n                for (i in this._functions){\n                    if (i.startsWith(token.value)){\n                        tip += `<p style=\"${i==token.value ? 'background:#00BCD4' : ''}\">${i}</p>`\n                    }\n                }\n            } else if (token.type=='IDENTIFIER' && !token.validate){\n                for (i in this._fields){\n                    n = i.substring(0, i.length - 1)\n                    if (i.startsWith(token.value)){\n                        tip += `<p style=\"${n==token.value ? 'background:#00BCD4' : ''}\">${i}</p>`\n                    }\n                }\n            } else if (token.context){\n                o = this._functions[token.context]\n                if (o){\n                    tip = token.context + '('\n                    s = ''\n                    \n                    if (o.arguments){\n                        e = false\n                        for (i=0; i<o.arguments.length; i++){\n                            n = o.arguments[i].name\n                            b = (i == token.contextPos)\n                            \n                            if (b){\n                                e = true\n                            }\n                            \n                            tip += s + ( b || (i==o.arguments.length-1 && !e && o.arguments[i].several) ? `<b style=\"background:#f3dd9b\">${n}</b>` : n)\n                            s = '; '\n                        }\n\n                        tip += ')'\n                    }\n                }\n            }\n        }\n\n        document.getElementById('tip').innerHTML = tip\n\n        // if (this._onTip){\n        //     this._onTip(tip)\n        // }\n    }\n\n    // _getParamDefinition(position){\n    //     let token\n    //     let positions = this._tokenizer.getPositions()\n    \n    //     while (position >= 0){\n    //         token = positions[position]\n            \n    //         if (token && token.type != 'blank'){\n    //             this._validateToken(token)\n    //             return token\n    //         }\n    \n    //         position--\n    //     }\n    // }\n\n    // _validateToken(token){\n    //     let tokens = this._tokenizer.getTokens()\n    //     let j = token.index + 1\n    //     let i, tk\n\n    //     token.validate = false\n\n    //     if (token.type=='function'){\n    //         for (i=j; i<tokens.length; i++){\n    //             tk = tokens[i]\n                \n    //             if (tk.value == '('){\n    //                 return token.validate = this._functions[token.value] ? true : false\n    //             } else if (tk.type != 'blank'){\n    //                 return token.validate = false\n    //             }\n    //         }\n    //     } else if (token.type=='field'){\n    //         token.validate = this._fields[token.value] ? true : false\n    //     }\n    // }\n\n    _render(){\n        let tokens = this._tokens = tokenizer(this._textarea.value)\n        let html = ''\n        \n        tokens.forEach(token => {\n            if (token.type == 'FUNCTION'){\n                token.validate = this._functions[token.value] ? true : false\n            } else if (token.type == 'IDENTIFIER'){\n                token.validate = this._fields[token.value] ? true : false\n            } else if (token.type == 'STRING'){\n                token.value = `\"${token.value}\"`\n            } else if (token.type == 'UNCOMPLETE_STRING'){\n                token.value = `\"${token.value}`\n            } else if (token.type == 'NEWLINE'){\n                token.value = '\\n'\n            }\n\n            html += this._formatToken(token)\n        })\n        \n        this._pre.innerHTML = html + ' \\n'\n        this._textarea.style.height = this._pre.offsetHeight + 'px'\n    }\n\n    _formatToken(token){\n        let r = token.value\n        let cls = token.type + (token.validate===false ? ' UNVALIDATE' : '')\n\n        r = `<span class=\"${cls}\">${r}</span>`\n    \n        return r\n    }\n\n    setFunctions(functions){\n        this._functions = functions\n    }\n\n    setFields(fields){\n        this._fields = fields\n    }\n\n    getValue(){\n        return this._textarea.value\n    }\n\n    setValue(value){\n        this._textarea.value = value\n        this._render()\n    }\n\n    setDisabled(value){\n        this._textarea.disabled = value\n        value ? this._pre.setAttribute('disabled', '') : this._pre.removeAttribute('disabled')\n    }\n}\n","// @ts-check\n\n// https://gist.github.com/BonsaiDen/1810887\n\n/**\n  * Simple JavaScript tokenizer (not a full parser!!!)\n  *\n  * Portions taken from Narcissus by Brendan Eich <brendan@mozilla.org>.\n  */\n\n/* jshint evil: true, regexdash: false, regexp: false */\n\nlet KEYWORDS = [\n    'break',\n    'case', 'catch', 'const', 'continue',\n    'debugger', 'default', 'delete', 'do',\n    'else', 'enum',\n    'false', 'finally', 'for', 'function',\n    'if', 'in', 'instanceof',\n    'new', 'null',\n    'return',\n    'switch',\n    'this', 'throw', 'true', 'try', 'typeof',\n    'var', 'void',\n    'while', 'with'\n]\n\nlet OPERATORS = {\n    '>>>=': 'ASSIGN_URSH',\n    '>>=':  'ASSIGN_RSH',\n    '<<=':  'ASSIGN_LSH',\n    '|=':   'ASSIGN_BITWISE_OR',\n    '^=':   'ASSIGN_BITWISE_XOR',\n    '&=':   'ASSIGN_BITWISE_AND',\n    '+=':   'ASSIGN_PLUS',\n    '-=':   'ASSIGN_MINUS',\n    '*=':   'ASSIGN_MUL',\n    '/=':   'ASSIGN_DIV',\n    '%=':   'ASSIGN_MOD',\n    ';':    'SEMICOLON',\n    ',':    'COMMA',\n    '?':    'HOOK',\n    ':':    'COLON',\n    '||':   'OR',\n    '&&':   'AND',\n    '|':    'BITWISE_OR',\n    '^':    'BITWISE_XOR',\n    '&':    'BITWISE_AND',\n    '===':  'STRICT_EQ',\n    '==':   'EQ',\n    '=':    'ASSIGN',\n    '!==':  'STRICT_NE',\n    '!=':   'NE',\n    '<<':   'LSH',\n    '<=':   'LE',\n    '<':    'LT',\n    '>>>':  'URSH',\n    '>>':   'RSH',\n    '>=':   'GE',\n    '>':    'GT',\n    '++':   'INCREMENT',\n    '--':   'DECREMENT',\n    '+':    'PLUS',\n    '-':    'MINUS',\n    '*':    'MUL',\n    '/':    'DIV',\n    '%':    'MOD',\n    '!':    'NOT',\n    '~':    'BITWISE_NOT',\n    '.':    'DOT',\n    '[':    'LEFT_BRACKET',\n    ']':    'RIGHT_BRACKET',\n    '{':    'LEFT_CURLY',\n    '}':    'RIGHT_CURLY',\n    '(':    'LEFT_PAREN',\n    ')':    'RIGHT_PAREN'\n}\n\n// Regular Expressions --------------------------------------------------------\n// ----------------------------------------------------------------------------\nlet opMatch = '^'\nfor (let i in OPERATORS) {\n    if (opMatch !== '^') {\n        opMatch += '|^'\n    }\n\n    opMatch += i.replace(/[?|^&(){}\\[\\]+\\-*\\/\\.]/g, '\\\\$&')\n}\n\nlet opRegExp = new RegExp(opMatch),\n    fpRegExp = /^\\d+\\.\\d*(?:[eE][-+]?\\d+)?|^\\d+(?:\\.\\d*)?[eE][-+]?\\d+|^\\.\\d+(?:[eE][-+]?\\d+)?/,\n    reRegExp = /^\\/((?:\\\\.|\\[(?:\\\\.|[^\\]])*\\]|[^\\/])+)\\/([gimy]*)/,\n    intRegExp = /^0[xX][\\da-fA-F]+|^0[0-7]*|^\\d+/,\n    multiCommentRegExp = /^\\/\\*(.|[\\r\\n])*?\\*\\//m,\n    commentRegExp = /^\\/\\/.*/,\n    identRegExp = /^[$_\\w]+/,\n    wsRegExp = /^[\\ \\t]+/,\n    strRegExp = /^'([^'\\\\]|\\\\.)*'|^\"([^\"\\\\]|\\\\.)*\"/\n\n// Token Class ----------------------------------------------------------------\n// ----------------------------------------------------------------------------\nfunction Token() {\n    this.col = 1\n    this.line = 1\n    this.ws = {\n        indent: 0,\n        before: 0,\n        after: 0,\n        trailing: 0\n    }\n    \n    this.context = null\n    this.contextPos = null\n    this.argumentCount = null\n    this.cursor = null\n    this.flags = null\n    this.operator = null\n    this.type = null\n    this.value = null\n    this.plain = null\n    this.validate = null\n}\n\nToken.prototype.toString = function() {\n    return '[' + (this.type + '        ').substr(0, 13) + ' ' +\n            '[' + this.ws.indent + ':' + this.ws.before + ']' + this.line +\n            ':' + this.col + '[' + this.ws.after + ':' + this.ws.trailing +\n            ']' + ': ' + this.value + ']'\n}\n\n// Main Tokenizer function ----------------------------------------------------\n// ----------------------------------------------------------------------------\nfunction tokenize(input, tabWidth) {\n    let cursor = 0,\n        line = 1,\n        col = 0,\n        spaceBefore = 0,\n        indentation = 0,\n        // tabExpand = new Array((tabWidth || 4)).join(' '),\n        token = new Token(),\n        lastToken = null,\n        lastIdentifier = null,\n        activeContext = null,\n        list = [],\n        context = [],\n        contextPosition = 0\n\n    // Grab the inputs\n    while (cursor < input.length) {\n\n        // Save the last non-whitespace token\n        if (token.type !== 'WHITESPACE') {\n            lastToken = token\n        }\n\n        // Get the rest\n        // We also grab the rest of the line here for regexps\n        let sub = input.substring(cursor),\n            subline = sub.substring(0, sub.indexOf('\\n')),\n            m = null\n\n        // Create next token\n        token = new Token()\n        token.line = line\n        token.col = col\n        token.cursor = cursor\n        token.ws.indent = indentation\n        token.ws.before = lastToken.type === 'NEWLINE' ? 0 : spaceBefore\n\n        // Reset whitespace\n        spaceBefore = 0\n\n        // Newlines\n        if (sub[0] === '\\n') {\n\n            lastToken.ws.trailing = token.ws.before\n            token.ws.before = 0\n\n            token.type = 'NEWLINE'\n            token.value = '\\\\n'\n            token.plain = sub[0]\n            col = 0\n            line++\n\n        // Multi line comments\n        // don't ask how this regexp works just pray that it will never fail\n        } else if ((m = sub.match(multiCommentRegExp))) {\n            token.type = 'MULTI_COMMENT'\n            token.plain = m[0]\n            token.value = m[0].slice(2, -2)\n\n            let lines = token.plain.split('\\n')\n            line += lines.length - 1\n            col = lines[lines.length - 1].length - m[0].length + 1\n\n        // Comment\n        } else if ((m = subline.match(commentRegExp))) {\n            token.type = 'COMMENT'\n            token.plain = m[0]\n            token.value = m[0].substr(2)\n\n        // Float\n        } else if ((m = sub.match(fpRegExp))) {\n            token.type = 'FLOAT'\n            token.plain = m[0]\n            token.value = parseFloat(m[0])\n\n        // Integer\n        } else if ((m = sub.match(intRegExp))) {\n            token.type = 'INTEGER'\n            token.plain = m[0]\n            token.value = parseInt(m[0])\n\n        // String\n        } else if ((m = sub.match(strRegExp))) {\n            token.type = 'STRING'\n            token.plain = m[0]\n            token.value = eval(m[0]) // simpelst way to get the actual js string value, don't beat me, taken from narcissus!\n\n        // Uncomplete String\n        } else if (sub.startsWith('\"')) {\n            token.type = 'UNCOMPLETE_STRING'\n            token.plain = sub\n            token.value = sub.substring(1)\n            cursor += sub.length\n\n        // Identifier\n        } else if ((m = sub.match(identRegExp))) {\n            token.value = m[0]\n            token.type = KEYWORDS.indexOf(token.value) !== -1 ? 'KEYWORD' : 'IDENTIFIER'\n            if (token.type == 'IDENTIFIER'){\n                lastIdentifier = token\n            }\n\n        // Regexp, matches online on the same line and only if we didn't encounter a identifier right before it\n        } else if (lastToken.type !== 'IDENTIFIER' && (m = subline.match(reRegExp))) {\n            token.type = 'REGEXP'\n            token.plain = m[0]\n            token.value = m[1]\n            token.flags = m[2]\n\n        // Operator\n        } else if ((m = sub.match(opRegExp))) {\n\n            // Check for assignments\n            let op = OPERATORS[m[0]]\n            if (op.substring(0, 6) === 'ASSIGN') {\n\n                token.type = 'ASSIGN'\n                if (op === 'ASSIGN') {\n                    token.operator = null\n\n                } else {\n                    token.operator = op.substring(7)\n                }\n\n            } else {\n                token.type = op\n            }\n\n            token.value = m[0]\n\n        // Whitespace handling\n        } else if ((m = sub.match(wsRegExp))) {\n\n            token.type = 'WHITESPACE'\n            token.value = m[0]\n\n            // Provide meta information about whitespacing\n            spaceBefore = m[0].replace(/\\t/g, '    ').length\n            if (col === 1) {\n                indentation = spaceBefore\n\n            } else {\n                lastToken.ws.after = spaceBefore\n            }\n\n        // If we ever hit this... we suck\n        } else {\n            throw new Error('Unexpected: ' + sub[0] + ' on :')\n        }\n\n        // Add non-whitespace tokens to stream\n        if (token.type !== 'WHITESPACExxx') {\n            if (lastIdentifier){\n                if (token.value == '('){\n                    activeContext = lastIdentifier\n                    lastIdentifier.type = 'FUNCTION'\n                    context.push(lastIdentifier)\n\n                    contextPosition = 0\n                    activeContext.argumentCount = 1\n                } else if (token.value == ')'){\n                    context.pop()\n                    activeContext = context[context.length - 1]\n                } else if (token.value == ','){\n                    if (activeContext){\n                        contextPosition++\n                        activeContext.argumentCount = contextPosition + 1\n                    }\n                }\n            }\n\n            token.context = activeContext ? activeContext.value : null\n            token.contextPos = token.context ? contextPosition : null\n            \n            list.push(token)\n        }\n\n        // Advance cursor by match length\n        let len = 1\n        if (m) {\n            len = m[0].length + m.index\n        }\n\n        cursor += len\n        col += len\n\n    }\n\n    return list\n\n}\n\nexport default tokenize\n","// @ts-check\n\nimport Editor from '../src/editor'\n\nlet editor = new Editor(document.getElementById('editor'), {\n    onTip(tip){\n        document.getElementById('tip').innerHTML = tip\n    }\n})\n\neditor.setFunctions({\n    'sum': {\n        arguments: [\n            {\n                name: 'start', \n                type: 'text',\n                description: 'a primeira {context} do intervalo de soma'\n            },\n            {\n                name: 'end', \n                type: 'text',\n                description: 'a última {context} do intervalo de soma'\n            }\n        ]\n    },\n    'value': {\n        arguments: [\n            {\n                name: 'field', \n                type: 'field',\n                description: 'campo a definir o valor'\n            }\n        ]\n    },\n    'values': {\n        arguments: [\n            {\n                name: 'field1', \n                type: 'field',\n                description: 'campo a definir o valor'\n            },\n            {\n                name: 'field2', \n                type: 'field',\n                description: 'campo a definir o valor'\n            },\n            {\n                name: '[optional ...]', \n                type: 'field',\n                several: true,\n                description: 'campo a definir o valor'\n            }\n        ]\n    },\n    'if': {\n        arguments: [\n            {\n                name: 'condition', \n                type: 'boolean',\n                description: 'expressão a ser avaliada'\n            },\n            {\n                name: 'valueIfTrue', \n                type: 'field',\n                description: 'campo a definir o valor'\n            },\n            {\n                name: 'valueIfFalse', \n                type: 'field',\n                description: 'campo a definir o valor'\n            }\n        ]\n    },\n    'valuex': true\n})\n\neditor.setFields({\n    'a':1,\n    'bb':1\n})\n"],"sourceRoot":""}